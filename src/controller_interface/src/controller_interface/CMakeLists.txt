add_library(controller_interface_objs OBJECT
  src/controller_interface/command_handler.cpp
  src/controller_interface/measures_handler.cpp
  src/controller_interface/controller_interface.cpp
  src/selftest_strings.cpp
)

add_library(controller_interface_proto_objs OBJECT
  ${PROTO_GEN}
)

##Declare Node
add_executable(controller_interface
  $<TARGET_OBJECTS:controller_interface_objs>
  $<TARGET_OBJECTS:controller_interface_proto_objs>
  src/controller_interface/controller_interface_node.cpp
)

##Declare Nodelet
add_library(controller_interface_nodelet
  $<TARGET_OBJECTS:controller_interface_objs>
  $<TARGET_OBJECTS:controller_interface_proto_objs>
  src/controller_interface/controller_interface_node.cpp
)

## set compiler definitions for nodelet
set_target_properties(controller_interface_nodelet PROPERTIES COMPILE_DEFINITIONS "BUILD_NODELET")
#disable some warnings for autogenerated code
if ("${CMAKE_CXX_COMPILER_ID}" STREQUAL "GNU")
  set_target_properties(controller_interface_proto_objs PROPERTIES COMPILE_FLAGS "-Wno-suggest-override -Wno-zero-as-null-pointer-constant -Wno-all -Wno-extra")
endif()

if ("${CMAKE_CXX_COMPILER_ID}" STREQUAL "Clang")
  set_target_properties(controller_interface_proto_objs PROPERTIES COMPILE_FLAGS "-Wno-everything")
endif()

if(CMAKE_CXX_CLANG_TIDY)
 set_target_properties(controller_interface_proto_objs PROPERTIES CXX_CLANG_TIDY "")
endif()

add_dependencies(controller_interface_proto_objs
  protobuild
)

add_dependencies(controller_interface_objs 
  ${catkin_EXPORTED_TARGETS}
  protobuild
)

add_dependencies(controller_interface 
  ${catkin_EXPORTED_TARGETS}
  protobuild
  #${PROJECT_NAME}_gencfg
)

add_dependencies(controller_interface_nodelet
  ${catkin_EXPORTED_TARGETS}
  protobuild
  #${PROJECT_NAME}_gencfg
)

target_link_libraries(controller_interface
  ${catkin_LIBRARIES}
  ${common_LIBRARIES}
  ${control_LIBRARIES}
  ${PROTOBUF_LIBRARY}
)
target_link_libraries(controller_interface_nodelet
  ${catkin_LIBRARIES}
  ${common_LIBRARIES}
  ${control_LIBRARIES}
  ${PROTOBUF_LIBRARY}
)
